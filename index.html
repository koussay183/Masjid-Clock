<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/styleLogin.css">
    <!-- <script type="module" src="signupFire.js"></script> -->
</head>

<body>
    <div class="wrapper" >
        <div class="title-text">
            <div class="title login">ุชุณุฌูู ุฏุฎูู</div>
            <!-- <div class="title signup">Signup</div> -->
        </div>
        <div class="form-container">
            <!-- <div class="slide-controls">
                <input type="radio" name="slide" id="login" checked>
                <input type="radio" name="slide" id="signup">
                <label for="login" class="slide login">Login</label>
                <label for="signup" class="slide signup">Signup</label>
                <div class="slider-tab"></div>
            </div> -->
            <div class="form-inner">
                <form action="#" class="login">
                    <div class="field">
                        <input type="text" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" id="logemail" required>

                    </div>
                    <div class="field">
                        <input type="password" placeholder="ูููุฉ ุงูุณุฑ" id="logpass" required>
                        <span data-target="logpass" class="toggle-password">๐๏ธ</span>
                    </div>
                    <!-- <div class="pass-link"><a href="#">Forgot password?</a></div> -->
                    <div class="field btn">
                        <div class="btn-layer"></div>
                        <input type="submit" value="ุฏุฎูู" id="loginbtn">
                    </div>
                    <div class="guest">ุงูุฏุฎูู ูุถููุ <a href="https://www.innovationladders.com/manarah">ุงุถุบุท ููุง</a></div>
                    <div class="support">ููุฏุนู ุงู ุงูุงุณุชูุณุงุฑุงุช, ูุฑุฌู ุงูุชูุงุตู ุนู ุทุฑูู ุจุฑูุงูุฌ ุงููุงุชุณ ุงุจ ุนูู ุงูุฑูู 00966554344899</div>
                    
                </form>
                <!-- <form action="#" class="signup">
                    <div class="field">
                        <input type="text" placeholder="Email Address" id="signemail" required>
                    </div>
                    <div class="field">
                        <input type="password" placeholder="Password" id="signpass" required>
                        <span data-target="signpass" class="toggle-password">๐๏ธ</span>
                    </div>
                    <div class="field">
                        <input type="password" placeholder="Confirm password" id="confirmpass" required>
                        <span data-target="confirmpass" class="toggle-password">๐๏ธ</span>
                    </div>
                    <div class="field btn">
                        <div class="btn-layer"></div>
                        <input type="submit" value="Signup" id="signupbtn">
                    </div>
                    <div class="login-link">Already have an account? <a href="">Login now</a></div> -->
                </form>
            </div>
        </div>
    </div>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAoO1sTD7c29cXuf7Ym2EFWFWf4sT-dhGQ",
            authDomain: "manarahclock.firebaseapp.com",
            projectId: "manarahclock",
            storageBucket: "manarahclock.appspot.com",
            messagingSenderId: "787657770789",
            appId: "1:787657770789:web:028b6a3eb9cc7a32827ccc"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        // get ref to database services
        const db = getDatabase(app);

        document.getElementById('loginbtn').addEventListener('click', function (e) {
            e.preventDefault();
            const email = document.getElementById("logemail").value.trim();
            const password = document.getElementById("logpass").value.trim();

            var recordRef = ref(db, `users/${email.split("@")[0].replace(/[.#$\[\]]/g, "")}`);

            get(recordRef).then((snapshot) => {
                let databaseValue = snapshot.val();
                // console.log(databaseValue);
                if (databaseValue) {
                    // User record found
                    var storedPassword = databaseValue.password;
                    if (password === storedPassword) {
                        // Password matches
                        console.log("Password matches. User authenticated.");
                        // Redirect to a new page or perform other actions as needed

                        // Construct the URL with parameter
                        var destination = 'msqInfo.html?parameter=' + encodeURIComponent(`${email.split("@")[0].replace(/[.#$\[\]]/g, "")}`);
                        window.location.href = destination;
                    } else {
                        // Password does not match
                        console.log("Password does not match. Authentication failed.");
                        // Display error message to the user
                        alert("ูููุฉ ุงูุณุฑ ุบูุฑ ุตุญูุญุฉ");
                    }
                } else {
                    // User record not found
                    console.log("User not found. Authentication failed.");
                    // Display error message to the user
                    alert('ูุง ููุญุฏ ุญุณุงุจ ุจูุฐู ุงููุนูููุงุช')
                }

            }).catch((error) => {
                console.error("Error getting data:", error);
            });
        });


    </script>

    <script type="text/javascript" src="js/signinup.js"></script>
</body>

</html>